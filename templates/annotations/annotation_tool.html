{% extends "images/base_image.html" %}
{% load i18n %}
{% load guardian_tags %}

{% block title %}Annotation Tool | CoralNet{% endblock %}

{% block media-includes %}
    {{ block.super }}
    <script src="/static/js/AnnotationToolHelper.js" type="text/javascript"></script>
{% endblock %}

{% block content %}

<p>The annotation tool hasn't been made yet, but here you can see the annotation points for this image.</p>
<p>Image: {{ metadata.name }}</p>
<p>Location keys: {{ location_values|default:"(Unknown)" }}</p>
<p>Year: {{ metadata.photo_date.year|default:"(Unknown)" }}</p>
<p>Annotation point type: {{ image.point_gen_method_display }}</p>
<p>Annotation progress: {{ num_of_annotations }} of {{ num_of_points }} points done</p>

<!-- For the image and canvas, use position:absolute
and make their positions (left, top) the same.  This'll make
them overlap.  Use z-index to determine which "layers" are on
top or bottom.  Also, the surrounding div must have
position:relative so that the image and canvas don't overlap
the rest of the page elements. -->

<div id="annotationArea" style="position: relative;">

    <!-- The coral image  -->
    <img id="coralImage" src="{{ image.original_file.url }}"
         style="position: absolute;" />

    <!-- HTML5 canvas element for drawing points -->
    <canvas id="pointsCanvas"
        style="position: absolute;">
    </canvas>
</div>

{% if num_of_annotations > 0 %}
  <hr />

  <div id="annotationList">
    <table>
    {% for a in annotations %}
      <tr>
        <td style="padding-left: 20px; padding-right: 20px;">{{ a.point_number }}</td>
        <td style="padding-left: 20px; padding-right: 20px;">{{ a.label__name }}</td>
        <td style="padding-left: 20px; padding-right: 20px;">{{ a.label__code }}</td>
      </tr>
    {% endfor %}
    </table>
  </div>
{% endif %}

<!-- Script in the body will run on page load. -->
<script type="text/javascript">
    AnnotationToolHelper.init({{ initial_display_height }},
                              {{ initial_display_width }},
                              {{ image.original_height }},
                              {{ image.original_width }},
                              {{ annotationsJSON|safe }} );
</script>

{% endblock %}
