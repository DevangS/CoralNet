{% extends "images/base_image.html" %}
{% load i18n %}
{% load guardian_tags %}

{% block title %}{{ metadata.name }} | CoralNet{% endblock %}

{% block javascript-functions %}
<script type="text/javascript">

    var ORIGINAL_WIDTH = {{ image.original_width }};
    var SCALED_WIDTH = {{ scaled_width }};

    function initImageDetailPage() {
        $("#coralImage").width(SCALED_WIDTH);

        if (ORIGINAL_WIDTH == SCALED_WIDTH) {
            $("#originalWidthButton").hide();
            $("#scaledWidthButton").hide();
        }
        else {
            $("#originalWidthButton").show();
            $("#scaledWidthButton").hide();
        }
    }

    function setImageToOriginalWidth() {
        $("#coralImage").width(ORIGINAL_WIDTH);
        $("#scaledWidthButton").show();
        $("#originalWidthButton").hide();
    }
    function setImageToScaledWidth() {
        $("#coralImage").width(SCALED_WIDTH);
        $("#originalWidthButton").show();
        $("#scaledWidthButton").hide();
    }

</script>
{% endblock %}

{% block content %}

    <button type="button" id="originalWidthButton" onclick="setImageToOriginalWidth()">View full image</button>
    <button type="button" id="scaledWidthButton" onclick="setImageToScaledWidth()">Scale image to page</button>

    <img id="coralImage" src="{{ image.original_file.url }}" />
    
    <hr />

    <div class="detail_list">
    
    <div>
    {% for detail in detailsets.keys %}
        <p>{{ detail.label }}: {{ detail.value }}</p>
    {% endfor %}
    </div>

    <div>
    {% if metadata.height_in_cm %}
      <p>Height coverage: {{ metadata.height_in_cm }} centimeters</p>
    {% else %}
      <p>Height coverage: (Not specified)</p>
    {% endif %}
    
    <p>Full resolution: {{ image.original_width }} x {{ image.original_height }} pixels</p>
    </div>

    <div>
    <p>Upload date: {{ image.upload_date }}</p>
    <p>Uploaded by: {{ image.uploaded_by|default:"(Unknown)" }}</p>
    
    {% for detail in detailsets.other_info %}
        {% if detail.value %}
            {% if detail.name == 'comments' %}
                <p>{{ detail.label }}:</p>
                <p style="margin-left: 30px;">{{ detail.value|linebreaksbr }}</p>
            {% else %}
                <p>{{ detail.label }}: {{ detail.value }}</p>
            {% endif %}
        {% endif %}
    {% endfor %}
    </div>

    <div>
    {% get_obj_perms user for source as "source_perms" %}
    {% if "source_edit" in source_perms %}
    <a href="{% url image_detail_edit source.id image.id %}">{% trans 'Edit Image Details' %}</a>
    {% endif %}
    </div>

    </div>

    <!-- Script in the body will run on page load. -->
    <script type="text/javascript">

        initImageDetailPage();

    </script>

{% endblock %}
