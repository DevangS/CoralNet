{% extends "images/base_source.html" %}
{% block title %}{{ source.name }} - Statistics | CoralNet{% endblock %}

{% block css-code %}
<style type="text/css">
img {
    float:left;
}
table.sample {
	border-width: 1px;
	border-spacing: 0px;
	border-style: outset;
	border-color: gray;
	border-collapse: separate;
	background-color: white;
    float: left;
}
table.sample th {
	border-width: 1px;
	padding: 1px;
	border-style: inset;
	border-color: gray;
	background-color: white;
}
table.sample td {
	border-width: 1px;
	padding: 1px;
	border-style: inset;
	border-color: gray;
	background-color: white;
}
</style>
{% endblock %}

{% block javascript-functions %}
    <script type="text/javascript">
       $(document).ready(function(){
            $("#selectAll").change(function() {
                $(".:checkbox").attr('checked', this.checked);
            });
       });
    </script>
{% endblock %}

{% block content %}
    <h2>Statistics</h2>

    <p>Pick a set of images and labels to generate statistics for using the form below. This will generate
    a line graph that shows the yearly percent coverage for each chosen label from the specified set of images over all the years
    that there exists data for. </p>
    <br/>
    <p>Large queries may take a while so please be patient! Also note that choosing too many labels may cause some lines to have the same colour.</p>
    
    <hr/>

    <!-- This is the menu to select descriptors to sort through the images -->

        <fieldset class="fieldset_statistics">
            {% if errors %}
                <ul>
                    {% for error in errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                  <div align="center">
                    {% if label_table %}
                        <h3>Labels</h3>
                        <table class="sample">
                          <tr>
                              <td></td>
                              {% for year in years %}
                                <td>{{ year }} % coverage</td>
                                <td>{{ year }} total annotations</td>
                              {% endfor %}
                          </tr>
                          {% for row in label_table %}
                              <tr>
                                  {% for cell in row %}
                                      <td>{{ cell }}</td>
                                  {% endfor %}
                              </tr>
                        {% endfor %}
                        </table>
                    {% endif %}
                  </div><br/>
                  <div align="center">
                    {% if group_table %}
                        <h3>Functional Groups</h3>
                        <table class="sample">
                            <tr>
                                  <td></td>
                                  {% for year in years %}
                                    <td>{{ year }} % coverage</td>
                                    <td>{{ year }} total annotations</td>
                                  {% endfor %}
                              </tr>
                              {% for row in group_table %}
                                  <tr>
                                      {% for cell in row %}
                                          <td>{{ cell }}</td>
                                      {% endfor %}
                                  </tr>
                               {% endfor %}
                        </table>
                    {% endif %}
            </div>
            <div align="center"><img src={{ graph }} /></div>
            {% endif %}
            <br/><br/><br/> &nbsp;
        </fieldset>
        <form action="" method="get">

            <legend class="smaller">Specify some image search parameters <i>(optional)</i>:</legend>
            <br/>
            {{ form.value1.label }}&nbsp;{{ form.value1 }}&nbsp;
            {{ form.value2.label }}&nbsp;{{ form.value2 }}&nbsp;
            {{ form.value3.label }}&nbsp;{{ form.value3 }}&nbsp;
            {{ form.value4.label }}&nbsp;{{ form.value4 }}&nbsp;
            <br/><br/><br/>

            <legend class="smaller">Choose some functional groups or labels <i>(required)</i>:</legend>
            <br/>

            <div style="text-align: center;">
                <input type="checkbox" id="selectAll">
                <label for="selectAll">SELECT ALL</label>
            </div>
            <br/>

            Groups
            <br/><br/>
            {% for groupId, groupName in form.groups.field.choices %}
              <div class="grid_checkbox_field_wrapper">
                <input id="id_groups_{{ groupId }}" type="checkbox" value="{{ groupId }}" name="groups">
                <label class="grid_checkbox" for="id_groups_{{ groupId }}">{{ groupName }}</label>
              </div>
            {% endfor %}
            <br/><br/>

            Labels
            <br/><br/>
            {% for labelId, labelName in form.labels.field.choices %}
              <div class="grid_checkbox_field_wrapper">
                <input id="id_labels_{{ labelId }}" type="checkbox" value="{{ labelId }}" name="labels">
                <label for="id_labels_{{ labelId }}">{{ labelName }}</label>
              </div>
            {% endfor %}
            <br/><br/>

            Include Robot Annotations:{{  form.include_robot }}
        <div class="submit_button_wrapper_center">
           <input type='submit' value="Search">
        </div>
    
    </form>
{% endblock %}
